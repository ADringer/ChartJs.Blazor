@page "/BubbleChart"
@using BlazorComponents.Shared

<h2>Chart JS charts using Blazor</h2>
<div class="row">
    <button class="btn btn-primary" onclick="@UpdateChart">Update Chart </button>
</div>
<ChartJsBubbleChart ref="bubbleChartJs" Chart="@blazorBubbleChartJS" Width="600" Height="300" />

@functions{

    public ChartJSChart<ChartJsBubbleDataset> blazorBubbleChartJS { get; set; } = new ChartJSChart<ChartJsBubbleDataset>();
    ChartJsBubbleChart bubbleChartJs;

    protected override void OnInit()
    {

        blazorBubbleChartJS = new ChartJSChart<ChartJsBubbleDataset>()
        {
            ChartType = "bubble",
            CanvasId = "myFirstBubbleChart",
            Options = new ChartJsOptions()
            {
                Text = "Sample chart from Blazor",
                Display = true,
                Responsive = false
            },
            Data = new ChartJsData<ChartJsBubbleDataset>()
            {
                Labels = new List<string>() { "Red", "Blue", "Yellow", "Green", "Purple", "Orange" },
                Datasets = new List<ChartJsBubbleDataset>()
             {
                    new ChartJsBubbleDataset()
                    {
                        BackgroundColor = "#ff6384",
                        BorderColor = "#ff6384",
                        Label = "# of Votes from blazor",
                        Data = new List<dynamic>
                        {
                            new BubbleData(){x = 1, y = 1, r = 1},
                            new BubbleData(){x = 2, y = 2, r = 2},
                            new BubbleData(){x = 3, y = 3, r = 3},
                            new BubbleData(){x = 4, y = 4, r = 4},
                            new BubbleData(){x = 5, y = 5, r = 5},
                            new BubbleData(){x = 6, y = 6, r = 6}
                        },
                        BorderWidth = 2,
                    }
             }
            }
        };
    }

    public void UpdateChart()
    {
        //Update existing dataset
        blazorBubbleChartJS.Data.Labels.Add($"New{DateTime.Now.Second}");
        var firstDataSet = blazorBubbleChartJS.Data.Datasets[0];
        firstDataSet.Data.Add(DateTime.Now.Second);

        //Add new dataset
        //blazorLineChartJS.Data.Datasets.Add(new ChartJsLineDataset()
        //{
        //    BackgroundColor = "#cc65fe",
        //    BorderColor = "#cc65fe",
        //    Label = "# of Votes from blazor 1",
        //    Data = new List<int> {20,21,12,3,4,4},
        //    Fill = true,
        //    BorderWidth = 2,
        //    PointRadius = 3,
        //    PointBorderWidth = 1
        //});

        bubbleChartJs.UpdateChart(blazorBubbleChartJS);
    }
}